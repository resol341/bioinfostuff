library(tidyverse)
library(magrittr)
setwd("~/GWAS/")
CARDIoGRAM <- read.delim("CARDIoGRAM_GWAS_RESULTS.txt")
CARD <- as_tibble(CARDIoGRAM)
CARD_igv <- select(CARD, chr_pos_.b36.,SNP,pvalue)
CARD_igv_final <- separate(CARD_igv, chr_pos_.b36., into=c("CHR", "BP"))
filter(CARD_igv_final, SNP %in% c("rs17062853", "rs12202017", "rs12524865", "rs9493752", "rs2327429", "rs2327433", "rs12190287", "rs11206510"))
write_delim(CARD_igv_final, "./CARD_igv.gwas", col_names = TRUE)

UKBB_raw <- read.delim("C4D_CAD_DISCOVERY_METAANALYSIS_UPDATE.TXT")
UKBB <- as_tibble(UKBB_raw)
C4D_igv <- select(C4D, CHR_POSB36,SNP,pvalue=PVALUE)
C4D_igv_final <- separate(C4D_igv, CHR_POSB36, into=c("CHR", "BP"))
filter(C4D, SNP %in% c("rs17062853", "rs12202017", "rs12524865", "rs9493752", "rs2327429", "rs2327433", "rs12190287"))
write_delim(C4D_igv_final, "./C4D_igv.gwas", col_names = TRUE)

UKBB_raw <- read.delim("UKBB.GWAS1KG.EXOME.CAD.SOFT.META.PublicRelease.300517.txt")
UKBB <- as_tibble(UKBB_raw)
UKBB_igv_final <- select(UKBB, CHR=chr, BP=bp_hg19, SNP=snptestid, pvalue=p.value_gc)
UKBB_igv_final_sig <- filter(UKBB_igv_final, pvalue<= 5*10^-8)
UKBB_igv_final_sig_dn <- drop_na(UKBB_igv_final_sig)
UKBB_igv_final_dn <- drop_na(UKBB_igv_final)
write_delim(UKBB_igv_final_dn, "./UKBB_igv_final_dn.gwas", col_names = TRUE)
write_delim(UKBB_igv_final_sig_dn, "./UKBB_igv_final_sig_dn.gwas", col_names = TRUE)
